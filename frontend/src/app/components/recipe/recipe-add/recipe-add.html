<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-8">
            <div class="card shadow" style="border-radius:1.5rem;">
                <div class="card-header bg-primary text-white" style="border-radius: 1.5rem 1.5rem 0 0;">
                    <h2 class="mt-2">âž• Add New Recipe</h2>
                </div>
                <div class="card-body">
                    <!-- Display errors if any -->
                    @if (errors.length > 0) {
                    <div class="alert alert-danger">
                        <ul class="mb-0">
                            @for (err of errors; track err) {
                            <li>{{ err }}</li>
                            }
                        </ul>
                    </div>
                    }
                    @if (error) {
                    <div class="alert alert-danger">
                        {{ error }}
                    </div>
                    }

                    <form [formGroup]="recipeForm" (ngSubmit)="onSubmit()" class="row g-4">
                        <!-- Basic Information -->
                        <div class="col-12">
                            <label for="title" class="form-label">Recipe Title</label>
                            <input type="text" class="form-control" id="title" formControlName="title"
                                placeholder="e.g., Chocolate Chip Cookies"
                                [class.is-invalid]="submitted && f['title'].errors">
                            @if (submitted && f['title'].errors) {
                            <div class="invalid-feedback">
                                @if (f['title'].errors['required']) {
                                <div>Title is required</div>
                                }
                                @if (f['title'].errors['minlength']) {
                                <div>Title must be at least 3 characters</div>
                                }
                                @if (f['title'].errors['maxlength']) {
                                <div>Title cannot exceed 100 characters</div>
                                }
                            </div>
                            }
                        </div>

                        <div class="col-md-6">
                            <label for="chef" class="form-label">Chef Name</label>
                            <input type="text" class="form-control" id="chef" formControlName="chef"
                                placeholder="e.g., John Smith">
                        </div>

                        <div class="col-md-6">
                            <label for="prepTime" class="form-label">Preparation Time (minutes)</label>
                            <input type="number" class="form-control" id="prepTime" formControlName="prepTime"
                                placeholder="e.g., 30" [class.is-invalid]="submitted && f['prepTime'].errors">
                            @if (submitted && f['prepTime'].errors) {
                            <div class="invalid-feedback">
                                @if (f['prepTime'].errors['required']) {
                                <div>Prep time is required</div>
                                }
                                @if (f['prepTime'].errors['min']) {
                                <div>Prep time must be at least 1 minute</div>
                                }
                                @if (f['prepTime'].errors['max']) {
                                <div>Prep time cannot exceed 480 minutes</div>
                                }
                            </div>
                            }
                        </div>

                        <!-- Recipe Details -->
                        <div class="col-md-6">
                            <label for="mealType" class="form-label">Meal Type</label>
                            <select class="form-select" id="mealType" formControlName="mealType"
                                [class.is-invalid]="submitted && f['mealType'].errors">
                                <option value="">Choose...</option>
                                @for (type of mealTypes; track type) {
                                <option [value]="type">
                                    {{ type.charAt(0).toUpperCase() + type.slice(1) }}
                                </option>
                                }
                            </select>
                            @if (submitted && f['mealType'].errors) {
                            <div class="invalid-feedback">
                                @if (f['mealType'].errors['required']) {
                                <div>Meal type is required</div>
                                }
                            </div>
                            }
                        </div>

                        <div class="col-md-6">
                            <label for="cuisineType" class="form-label">Cuisine Type</label>
                            <select class="form-select" id="cuisineType" formControlName="cuisineType"
                                [class.is-invalid]="submitted && f['cuisineType'].errors">
                                <option value="">Choose...</option>
                                @for (type of cuisineTypes; track type) {
                                <option [value]="type">
                                    {{ type.charAt(0).toUpperCase() + type.slice(1) }}
                                </option>
                                }
                            </select>
                            @if (submitted && f['cuisineType'].errors) {
                            <div class="invalid-feedback">
                                @if (f['cuisineType'].errors['required']) {
                                <div>Cuisine type is required</div>
                                }
                            </div>
                            }
                        </div>

                        <div class="col-md-6">
                            <label for="difficulty" class="form-label">Difficulty</label>
                            <select class="form-select" id="difficulty" formControlName="difficulty"
                                [class.is-invalid]="submitted && f['difficulty'].errors">
                                <option value="">Choose...</option>
                                @for (type of difficultyTypes; track type) {
                                <option [value]="type">
                                    {{ type.charAt(0).toUpperCase() + type.slice(1) }}
                                </option>
                                }
                            </select>
                            @if (submitted && f['difficulty'].errors) {
                            <div class="invalid-feedback">
                                @if (f['difficulty'].errors['required']) {
                                <div>Difficulty is required</div>
                                }
                            </div>
                            }
                        </div>

                        <div class="col-md-6">
                            <label for="servings" class="form-label">Servings</label>
                            <input type="number" class="form-control" id="servings" formControlName="servings"
                                placeholder="e.g., 4" [class.is-invalid]="submitted && f['servings'].errors">
                            @if (submitted && f['servings'].errors) {
                            <div class="invalid-feedback">
                                @if (f['servings'].errors['required']) {
                                <div>Servings is required</div>
                                }
                                @if (f['servings'].errors['min']) {
                                <div>Servings must be at least 1</div>
                                }
                                @if (f['servings'].errors['max']) {
                                <div>Servings cannot exceed 20</div>
                                }
                            </div>
                            }
                        </div>

                        <!-- Ingredients -->
                        <div class="col-12">
                            <label for="ingredients" class="form-label">Ingredients (one per line)</label>
                            <textarea class="form-control" id="ingredients" formControlName="ingredients" rows="5"
                                placeholder="Enter each ingredient on a separate line"
                                [class.is-invalid]="submitted && f['ingredients'].errors"></textarea>
                            @if (submitted && f['ingredients'].errors) {
                            <div class="invalid-feedback">
                                @if (f['ingredients'].errors['required']) {
                                <div>Ingredients are required</div>
                                }
                            </div>
                            }
                        </div>

                        <!-- Instructions -->
                        <div class="col-12">
                            <label for="instructions" class="form-label">Instructions (one per line)</label>
                            <textarea class="form-control" id="instructions" formControlName="instructions" rows="5"
                                placeholder="Enter step-by-step instructions separated by new lines"
                                [class.is-invalid]="submitted && f['instructions'].errors"></textarea>
                            @if (submitted && f['instructions'].errors) {
                            <div class="invalid-feedback">
                                @if (f['instructions'].errors['required']) {
                                <div>Instructions are required</div>
                                }
                            </div>
                            }
                        </div>

                        <!-- Buttons -->
                        <div class="col-12 d-flex justify-content-center mt-4 gap-2">
                            <button type="submit" class="btn btn-primary" [disabled]="loading">
                                @if (loading) {
                                <span class="spinner-border spinner-border-sm me-2" role="status"
                                    aria-hidden="true"></span>
                                }
                                {{ loading ? 'Creating...' : 'Add Recipe' }}
                            </button>
                            <button type="button" class="btn btn-secondary" (click)="cancel()" [disabled]="loading">
                                Cancel
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>